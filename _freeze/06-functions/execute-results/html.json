{
  "hash": "91e5a3189a387bffd52c8aee5c50efdb",
  "result": {
    "markdown": "# Formulas and Functions {#sec-functions}\n\n\n\n\n\n::: callout\n**OBJECTIVES**\n\n-   Types of functions and the syntax of a function.\n-   Entering a function manually, and with the Wizard.\n-   Nesting of functions.\n:::\n\nExcel has more than 300 built-in functions to perform a variety of operations. Features of the functions are divided into several categories, such as\n\n-   Database\n-   Date & Time\n-   Financial\n-   Information\n-   Logical\n-   Statistical\n-   Engineering\n-   Text\n-   Math & Trig\n-   Lookup & Reference\n\nA category can be useful when you are looking for a particular function. For example, if you are looking for a function to calculate the repayment of a loan, then this function can be found in the Financial category. Also, there are other categories: All, Most recently used and User defined.\n\nWith most of the features you need to specify what values or contents of cells the function should use in the calculation. These entries are called **arguments**.\n\nAll functions in Excel have the same construction (syntax), see @fig-function-syntax.\n\n![The structure (syntax) of a function.](images/functions/function-syntax.png){#fig-function-syntax}\n\n-   They start with the equal sign `=`.\n-   Then the function's name.\n-   Then round brackets (parentheses) enclosing the arguments. The arguments are separated by the so-called argument separator the comma (`,`).\n-   The arguments may include numbers, texts, operations, or also other functions.\n\n::: callout-warning\n1.  The separator for the arguments depends on a Windows setting. Default is the comma for English versions and a semicolon for the Dutch versions. You can change this through the control panel of Windows.\n\n2.  The function's name and the separation of arguments depends on the used language version in Microsoft Office.\n:::\n\nSome commonly used functions are discussed through tasks in this chapter.\n\n## Entering Functions {#sec-function-enter}\n\nYou can enter a function via a Wizard, but you can also enter it manually. Which method is best to use mainly depends on how experienced you are and whether you already know the name of the position and its structure. Both methods are explained below. The Wizard is used for the tasks in this chapter, but you can of course also use the manual method.\n\n### Function Wizard {#function-wizard}\n\nBeginners and less experienced users should use the [Function Wizard]{.uicontrol}. You can call this Wizard in two ways\n\n-   By clicking on the button $f_x$ [Insert function]{.uicontrol} at the beginning of the formula bar.\n-   Through [Formulas \\> Insert Function (group Function Library)]{.uicontrol}\n\nIn both cases the dialog box Insert Function appears:\n\n![Dialog box insert function.](images/functions/function-insert.png){#fig-function-insert}\n\nTo quickly find the right function, it is useful to first select a category of functions by clicking the selection arrow in the category box. The categories appear in the drop-down window. If you have no idea in which category the function belongs, then choose [All]{.uicontrol}.\n\nSelect the desired function, for example `COUNTIF` and click on [OK]{.uicontrol}. After this, the ***Function Arguments*** dialog box for the selected function appears.\n\n![Function arguments for function COUNTIF.](images/functions/function-countif.png){#fig-function-countif1}\n\nYou can specify the arguments in the dialog box. Which argument(s) you should use depends on the selected function. You can type in the arguments, but when it comes to cell addresses you can also select these cells in the worksheet with the mouse.\n\n::: callout-note\nBy clicking the link [Help on this function]{.uicontrol} you get detailed help for the function.\n:::\n\n### Autocomplete functions {#sec-function-manual}\n\nWhen you are familiar with a particular function, knowing the correct spelling and the types of arguments, you can choose to just type the function and its arguments into the input bar. Often this method is the most efficient.\n\nA very useful tool for this is **Autocomplete functions**. When you type a `=` character and the first letter of a function in a cell or in the input bar, Excel displays a drop-down list of all valid entries that start with that letter. Icons show the type of entry, such as a function or cell/table reference. And for each function you get a screen tip with a short description of the function.\n\nYou can continue typing the function to narrow the list or use the arrow keys to select the function from the list. After selecting the desired function, press [Tab]{.uicontrol} to insert the function and the opening parenthesis into the cell.\n\nAfter you press [Tab]{.uicontrol} to insert the function and the opening parenthesis, Excel displays another screen tip with the arguments for the function. The argument in bold is the argument you are currently entering. Arguments in parentheses are optional.\n\n::: {#exm-autocomplete}\n**Autocomplete**\n\nIn @fig-function-autocomplete you can see an example. In the first image, one letter, the `c`, has been entered. The list box shows all functions that start with `c`.\n\nIn the second image another two letters 'ou' has been typed. The list now consists of all items that start with `cou`. With the selected function 'COUNTIF' a screen tip is shown.\n\nAfter pressing [Tab]{.uicontrol} you get the third image. This function has two arguments.\n\n![Example autocomplete function.](images/functions/function-autocomplete.png){#fig-function-autocomplete}\n:::\n\n## Autosum {#sec-function-autosum}\n\nEntering a function via the Wizard often requires several mouse clicks. Because addition is the most used operation, Excel has a separate button, called [Autosum]{.uicontrol}, on the ribbon in the [Editing group (Home tab)]{.uicontrol} so that you can enter this function faster.\n\n![](images/functions/button-autosum.png)\n\nThrough the arrowhead at the end you can also get a selection list for the functions [Average]{.uicontrol}, [Count Numbers]{.uicontrol}, [Max]{.uiconrol} and [Min]{.uicontrol}, so these functions are also quickly accessible.\n\n::: {#prp-function-autosum}\n\n1.  Start with a new worksheet.\n\n2.  Enter in the cells A1:A6 in succession the following numbers: 120, 121, 122, 123, 124, and 125.\n\n3.  Select cell A7 and then click on [button Autosum]{.uicontrol}.\n\n![Selection borders around cells to sum.](images/functions/example-autosum.png){#fig-example-autosum}\n\nExcel places a selection border around the cells that you probably want to sum. If this is not the area you want to sum, then select with the mouse the correct area.\n\n4.  Confirm the selection by one of the following actions:\n\n    -   Click again on the [Autosum]{.uicontrol} button.\n    -   Click on button ![](images/functions/enter-function.svg) [Enter]{.uicontrol} in front of of the formula bar.\n    -   Press the [Enter]{.uicontrol} key on the keyboard.\n\nIn cell A7 the answer `735` is displayed. The formula in cell A7 is `=SUM(A1:A6)`. This formula is shorter and clearer, therefore better than a formula like `=A1+A2+A3+A4+A5+A6`.\n\n:::\n\n## Mathematical Functions {#sec-function-math}\n\nThe mathematical functions category is quite extensive. Besides the well-known SUM function for adding numbers, this category contains functions for various computing activities, such as exponentiation, root calculations, PI, logarithms, etc. Furthermore, you will find a lot of trigonometric functions. So all kinds of functions for a specific use.\n\nMore common functions are those for rounding numbers. Excel has thirteen functions for rounding and that is why it can be quite confusing to determine which function to use in a given situation. For example, there is a function `ROUND` for rounding a number up or down to a specified number of decimal places. There are also functions for rounding to the nearest multiples of a given number or rounding to an integer value.\n\n::: {#prp-function-math}\n[File]{.smallcaps}: `Rounding.xlsx`\n\n@fig-example-rounding shows the results of a number of rounding functions. Column C indicates which formulas have been used for column B.\n\n![Examples of rounding functions.](images/functions/example-rounding.png){#fig-example-rounding}\n\n1.  Open the file.\n\n2.  Enter the appropriate formulas in cells B3:B9 using the Function Wizard.\n\n:::\n\n## Statistical Functions {#sec-function-statistical}\n\nThe statistical category contains a variety of functions for statistical analysis like average, count, minimum, and maximum.\n\n::: {#prp-function-statistical}\n[File]{.smallcaps}: `Statistics.xlsx`\n\n![File Statistics.xlsx to practice statistical functions.](images/functions/example-statistical.png){#fig-example-statistical}\n\n1.  Open the file.\n\n2.  In cells B9 to B12, perform the calculations using the functions from the table below. The functions are in the category [Statistical]{.uicontrol}.\n\n    -   B9: `AVERAGE`\n    -   B10: `COUNT`\n    -   B11: `MIN`\n    -   B12: `MAX`\n\n::: callout-note\nThe argument is always the area B1:B8. You can of course type this in the function arguments dialog box, but it is more convenient to place the cursor in the box for the first argument and then select the area B1:B8 in the worksheet with the mouse.\n:::\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Result</button>\n ![](images/functions/example-statistical-result.png) \n</div>\n\n:::\n\n:::\n\n## Date and Time Functions {#sec-function-datetime}\n\nIn the Date and Time category, you will find multiple functions to perform calculations with date and time. Because Excel sees date and time internally as numbers you can just calculate with date and time. American date format: Month/Day/Year\n\n::: {#prp-function-datetime}\n[File]{.smallcaps}: `Date.xlsx`\n\n![Calculation with dates and times..](images/functions/example-datetime.png){#fig-example-datetime}\n\n1.  Open the file.\n\nFirst of all, the values for year, month and day are determined from the start and end dates.\n\n2.  Use the `YEAR`, `MONTH` and `DAY` functions to determine the values in cells C2, D2, and E2. The argument is always cell B2.\n\n3.  Select C2:E2 and drag the fill handle 1 row down.\n\n4.  Select cell B4 and enter the formula `=B3-B2`. The result will be 27.\n\nWith the function `NETWORKDAYS` you can determine the number of full working days between a start date and an end date. Weekends and dates defined as holidays do not count as working days. This function contains an optional argument to specify holidays.\n\n5.  Select cell B5 and calculate the number of working days. You only need to enter the cell addresses for start date and end date, you can leave the box for holidays empty.\n\n6.  The same way calculate the hours, minutes, and seconds from the start date and end date. Use the functions `HOUR`, `MINUTE`, and `SECOND`.\n\n7.  Calculate in B10 the time difference with a formula.\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Hint</button>\n You have to subtract the start time from the end time. \n</div>\n\n\n\n<div class='webex-solution'><button>Result</button>\n\n\n![](images/functions/example-datetime-result.png)\n\n\n</div>\n\n:::\n\n:::\n\n## Logical Function IF {#sec-function-logical}\n\nLogical functions do something with the results `TRUE` or `FALSE`. The best known and most widely used logical function is the `IF()` function. Simply said, the operation of this function does the following:\n\n`=IF(condition, what to do if true, what to do if false)`\n\nThe condition is a logical test with possible results `TRUE` or `FALSE`.\n\n::: callout-note\nIf you need more than one condition, then you can use a new `IF()` function inside the first `IF()` function. Such structures become quickly complicated and difficult to read. Better make use of the logical functions `AND()`, `OR()`, and `NOT()`.\n:::\n\n::: {#prp-function-logical}\n\nIn @fig-example-logical-result you see some marks, with next to it the statement pass or fail. This result should be automatically determined from the value of the grade. A result is unsatisfactory if the number is less than 5.5.\n\n![Marks with their results.](images/functions/example-logical-result.png){#fig-example-logical-result}\n\n1.  Start with a new worksheet and enter the numbers as shown in @fig-example-logical-result.\n\n2.  Select cell B2 and choose via [Insert Function]{.uicontrol} the function `IF`.\n\n3.  Complete the dialog box as shown in @fig-example-logical-if. You can enter the quotation marks around the texts, but you don't have to, Excel will place them automatically.\n\n![Dialog box function IF.](images/functions/example-logical-if.png){#fig-example-logical-if}\n\n4.  Click [OK]{.uicontrol}.\n\n5.  Select cell B2 and drag the fill handle to B6.\n\n:::\n\n## Text Functions {#sec-function-text}\n\nA task splitting a text into different parts by using four text functions.\n\nExcel has several functions for performing operations on texts. For example, you can determine the length of a text and retrieve certain pieces of text from a larger text.\n\nIn @fig-example-text-result, you see some full names in column A. The idea is to extract the first and last names out of the full names and put these in separate columns. In the example, the first and last names are separated by a space. This makes it possible to split the text at this point. To extract the different parts you need to know the location of the space. The text before the space is the first name and the text after the space is the last name. To determine the right part, you also need to know the total length of the text.\n\nThe result of the operations can be seen in @fig-example-text-result in columns B to E. Because 4 different functions are used, the practice is set up in four parts.\n\n![Full names and the extracted fiirst and last names.](images/functions/example-text-result.png){#fig-example-text-result}\n\n### LEN {#sec-function-length}\n\nDetermination of the length of a text with function `LEN`.\n\n::: {#prp-function-text}\n[File]{.smallcaps}: `Names.xlsx`\n\n1.  Open the file.\n\n2.  Select cell B2 and insert function `LEN` with argument A2.\n\n3.  Drag the fill handle in B2 down to B5.\n\nYou now have the length of the full names in column B..\n\n:::\n\n### SEARCH {#sec-function-search}\n\nThe starting position of a character (string), in this case a space, in a text can be determined with the function `SEARCH`.\n\n::: {#prp-function-search}\n\n1.  Select cell [C2]{.uicontrol} and press the button [Insert Function]{.uicontrol} on the formula bar.\n\n![Arguments for function SEARCH. Enter a space in the Find-text box. Excel surrounds this automatically with double quotes.](images/functions/example-text-search.png){#fig-example-text-search}\n\n2.  Click [OK]{.uicontrol}.\n\n3.  Drag the fill handle in C2 down to C5.\n\nIn column C you now have the position of the first space in the text.\n\n:::\n\n### LEFT {#sec-function-left}\n\nThe left part with a certain length of a text can be determined with the function `LEFT`. In this example, the first name is the left part.\n\n::: {#prp-function-left}\n\n1.  Select cell D2, insert the function `LEFT` and specify the arguments as shown in @fig-example-text-left.\n\n::: callout-note\nIn the Num-chars box, you need to specify the length of the text to extract. This is one less than the position of the space and that position can be found in cell C2.\n:::\n\n![Arguments for function LEFT.](images/functions/example-text-left.png){#fig-example-text-left}\n\n2.  Click [OK]{.uicontrol}.\n\n3.  Drag the fill handle in D2 down to D5.\n\nThe first names are now in column D.\n:::\n\n### RIGHT {#sec-function-right}\n\nThe right part with a certain length can be determined with the function `RIGHT`. In this example, the last name is the right part.\n\n::: {#prp-function-right}\n\n1.  Select cell E2, insert the function `RIGHT` and specify the arguments as shown in @fig-example-text-right.\n\n![Arguments for function RIGHT.](images/functions/example-text-right.png){#fig-example-text-right}\n\n2.  Click [OK]{.uicontrol}.\n\n3.  Drag the fill handle in E2 down to E5.\n\nThe last names are now in column E.\n\n:::\n\n## Nested Functions {#sec-function-nesting}\n\nA function as an argument inside another function is a nested function. Inside the parenthesis of a function, there is another function. An example:\n\n`=ROUNDDOWN(SUM(A1:A5),0)`\n\nThis nested function will be used in the following task.\n\n::: {#prp-function-nesting}\n\n1.  Start with a new worksheet and enter the data you can see in @fig-example-nesting.\n\n![Data to use with nested function.](images/functions/example-nesting.png){#fig-example-nesting}\n\n2.  Select cell A6 and insert function `ROUNDDOWN` (category [Math & Trig]{.uicontrol}).\n\nIn the dialog box for this function's arguments, the cursor is in the [Number]{.uicontrol} box. It is handy to first specify the number of decimal places and after that the range of numbers.\n\n3.  Put the cursor in the `Num_digits]{.uicontrol} box and enter [0`, and put the cursor back in [Number]{.uicontrol} box.\n\n![Dialoogvenster.](images/functions/example-nesting-decimals.png){#fig-example-nesting-decimals}\n\n4.  Click now in the worksheet on the arrow in the name box.\n\nA drop-down list with the names of the most recently used functions appears and at the bottom of the list [More functions]{.uicontrol}.\n\n5.  Click on [More functions]{.uicontrol}. The well known Insert Function dialog box appears.\n\n6.  Select in the [Math & Trig]{.uicontrol} category the function `SUM` and click [OK]{.uicontrol}.\n\nThe Function Arguments dialog box appears. Argument [Number1]{.varname} has already the value A1:A5.\n\n7.  Click [OK]{.uicontrol}.\n\nThe answer now appears in cell A6 and the used formula is displayed in the formula bar.\n\n![Result nested function.](images/functions/example-nesting-result.png){#fig-example-nesting-result}\n\n::: callout-note\n1.  If you had not entered the number of decimals after step 3, you would have received a warning during nesting that too few arguments were entered. You would have had to correct this manually in the formula.\n\n2.  A faster way of working is to manually type the formula in the formula bar. While you are typing, you will receive help with entering. Handling this way, you must know the names of the functions to be used.\n:::\n\n:::\n\n## COUNTIF {#sec-function-countif}\n\nThe `COUNTIF` function is very useful when creating frequency tables. In @fig-example-countif, you see a list of camping sites with their category. In column E should come the number of campsites in each category.\n\n![Campsites by category.](images/functions/example-countif.png){#fig-example-countif}\n\n::: {#prp-function-countif}\n[File]{.smallcaps}: `Campsites.xlsx`\n\n1.  Open the file.\n\n2.  Select cell E2, insert the function `COUNTIF` and specify the arguments as shown in @fig-function-countif2.\n\n![Arguments for the function COUNTIF.](images/functions/function-countif.png){#fig-function-countif2}\n\n::: callout-note\nBy specifying the entire column B as range, new rows with data can be added to the bottom without the need to change the formulas.\n:::\n\n3.  Click [OK]{.uicontrol}.\n\n4.  Select cell E2 and drag the fill handle down to E5.\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Result</button>\n ![](images/functions/example-countif-result.png) \n</div>\n\n:::\n\n:::\n\n## SUMIF {#sec-function-sumif}\n\nThe `SUMIF` function can be used to add numbers under certain conditions. The spreadsheet has a list of the yields of different coffee types per month and per region. You need to determine the total yields per region.\n\n::: {#prp-function-sumif}\n[File]{.smallcaps}: `Coffee.xlsx`\n\n1.  Open the file.\n\n2.  Select cell H2, insert the function `SUMIF` and specify the arguments as shown in @fig-example-sumif-arguments.\n\n![Arguments for function SUMIF.](images/functions/example-sumif-arguments.png){#fig-example-sumif-arguments}\n\n3.  Click [OK]{.uicontrol}. The total yield for region North 743140 now appears in cell H2.\n\n4.  Select cell H2 and drag down the fill handle to H5.\n\n5.  Format the numbers in H2:H5 as currencies.\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Resultaat</button>\n ![](images/functions/example-sumif-result.png) \n</div>\n\n:::\n\n::: callout-note\nAn addition in this example is easier to create with pivots.\n:::\n\n:::\n\n## Calculating Annuities {#sec-function-annuity}\n\nThere are several ways to determine the repayment of a loan. The following example calculates the size of the monthly repayment of a loan of \\$ 250,000 with a 6% fixed annual interest rate over a period of 15 years according to the annuity. For this, the Excel function `PMT` will be used. This function calculates the payment for a loan based on constant periodic payments and a constant interest rate.\n\n![Data to use for loan repayment.](images/functions/example-annuity.png){#fig-example-annuity}\n\n::: {#prp-function-annuity}\n[File]{.smallcaps}: `Repayment.xlsx`\n\n1.  Open the file and format the cells as shown in @fig-example-annuity.\n\n2.  Select cell B4, insert the function `PMT` (category [Financial]{.uicontrol}) and specify the arguments as shown in @fig-example-annuity-arguments.\n\n![Arguments for function PMT.](images/functions/example-annuity-arguments.png){#fig-example-annuity-arguments}\n\n::: callout-note\nBecause the period in this example is in months and not in years, the annual rate must be divided by 12 and the number of years must be multiplied by 12.\n:::\n\n3.  Click [OK]{.uicontrol}.\n\n::: callout-warning\nThe answer -2109.64 appears. Because the result is an amount to be paid, so a debt, Excel displays this as a negative number. That is, in a red font and with a minus sign.\n:::\n\n4.  Change this in a positive number by putting a minus sign after the `=` sign. So the formula becomes `=-PMT(B2/12,B3*12,B1)`\n\n:::\n\n## Calculating Number of Periods {#sec-function-nper}\n\nWhen taking a personal loan of € 4000 you agreed to pay a monthly amount of € 125. Calculate the number of months you have to repay at a 6% fixed annual interest rate. For this calculation, the Excel function `NPER` will be used. This function calculates the number of periods for an investment based on periodic, constant payments and a constant interest rate.\n\n::: callout-warning\nPayments are entered as negative numbers.\n:::\n\n![Calculation number of periods.](images/functions/example-nper.png){#fig-example-nper}\n\n::: {#prp-function-nper}\n[File]{.smallcaps}: `Payment_Periods.xlsx`\n\n1.  Open the file.\n\n2.  Select cell B4, insert the function `NPER`(category [Financial]{.uicontrol}) and specify the arguments as shown in @fig-example-nper-arguments.\n\n![Arguments for function NPER.](images/functions/example-nper-arguments.png){#fig-example-nper-arguments}\n\n::: callout-note\nBecause the period is in months and not in years, the annual rate has been divided by 12.\n:::\n\n3.  Click [OK]{.uicontrol}. The answer 34,95778166 appears, so almost 35 months.\n\n:::\n\n## Vertical Lookup {#sec-function-vlookup}\n\nThe `VLOOKUP` function looks up for a supplied value in the first column of a list (table) and returns the corresponding value from another column.\n\nSyntax: `VLOOKUP(lookup-value, table-array, col-index-num, [range-lookup])`\n\nThe last argument is optional and can be set to FALSE or TRUE.\n\n-   FALSE: Search for an exact match with the supplied lookup-value.\n-   TRUE: Give the closest match below the supplied value if an exact match can not be found.\n\n::: callout-note\nMost of the time it is best to search for an exact match, otherwise incorrect results are possible. If an approximation is allowed then the left column of the table-array must be in ascending order.\n:::\n\nIn @fig-example-vlookup is an overview of hard drives, with the article number in the first column. With the `VLOOKUP` function, you can find the capacity, type, and price of an article if you specify the article number.\n\n![Overview hard drives.](images/functions/example-vlookup.png){#fig-example-vlookup}\n\nCell D2 is the input cell for the article number to be searched. The cells D4:D7 are for the lookup formulas.\n\n::: {#prp-function-vlookup}\n[File]{.smallcaps}: `Harddisks.xlsx`\n\n1.  Open the file.\n\n2.  Select cell D4 and enter the formula: `=VLOOKUP($D$2,$B$11:$E$22,1,FALSE)`.\n\nAs result, the error `#N/A` appears in the cell. This is because there is no search value in cell D2.\n\n3.  Enter in cell D2 the value `208`. In cell D4 now appears 208, the article number.\n\n4.  Now enter the correct lookup formulas in the other three cells.\n\n    -   in D5 the formula: `=VLOOKUP($D$2,$B$11:$E$22,2,FALSE)`.\n\n    -   in D6 the formula: `=VLOOKUP($D$2,$B$11:$E$22,3,FALSE)`.\n\n    -   in D7 the formula: `=VLOOKUP($D$2,$B$11:$E$22,4,FALSE)`.\n\n![Results VLOOKUP.](images/functions/example-vlookup-result.png){#fig-example-vlookup-result}\n\n:::\n\n## Horizontal Lookup {#sec-function-hlookup}\n\nThe `HLOOKUP` function looks up for a supplied value in the first row of a list (table) and returns the corresponding value from another row.\n\nSyntax: `VLOOKUP(lookup-value, table-array, row-index-num, [range-lookup])`\n\nThe last argument is optional and can be set to FALSE or TRUE.\n\n-   FALSE: Search for an exact match with the supplied lookup-value.\n-   TRUE: Give the closest match below the supplied value if an exact match can not be found.\n\n::: callout-note\nIt is mostly the best to specify to search for an exact match, otherwise incorrect results are possible. And if an approximation is allowed then the first row of the table-array must be in ascending order.\n:::\n\nIn @fig-example-hlookup is an overview of shoe sizes for some people with the name in the first row. When you specify the name you can find the corresponding age, length, and shoe size with the HLOOKUP function.\n\n![Overview shoe sizes.](images/functions/example-hlookup.png){#fig-example-hlookup}\n\nCell C2 is the input cell for the name to be searched. The cells C4:C6 are for the lookup formulas.\n\n::: {#prp-function-hlookup}\n[File]{.uicontrol}: `Shoe_Sizes.xlsx`\n\n1.  Open the file.\n\n2.  Select cell C4 and enter the formula `=HLOOKUP($C$2,$C$8:$E$11,2,FALSE)`.\n\nAs result, the error #N/A appears in the cell. This is because there is no search value in cell C2.\n\n3.  Enter in cell C2 the value `Pietersen`. In cell C4 now appears 42, the age.\n\n4.  Now enter the correct lookup formulas in the other two cells.\n\n    -   in C5 the formula: `=HLOOKUP($C$2,$C$8:$E$11;3,FALSE)`.\n\n    -   in C6 the formula: `=HLOOKUP($C$2,$C$8:$E$11;4,FALSE)`.\n\n![Results HLOOKUP.](images/functions/example-hlookup-result.png){#fig-example-hlookup-result}\n\n:::\n\n## Exercises {#sec-functions-exercises}\n\n::: {#exr-form001}\n**Results computer company (form001)**\n\nThe following table reflects the results of a computer company for the year 2010. The company's target is to achieve a gross profit per product of more than $ 5000,- and a realized margin of more than 15%. Only if both targets are realized, the operating result can be characterized as good, in all other cases as bad.\n\n![](images/functions/form001-data.png)\n\nCreate this model in a worksheet. Formulas should be used for the determination of the gross profit, the margin, and the result. If the gross profit and margin targets will be changed then the result should be adjusted.\n\n[File]{.smallcaps}: `Form001.xlsx`\n:::\n\n::: {#exr-form002}\n**Lookup article details (form002)**\n\nA computer store has the following article information in a table: article number, name, and price. To quickly search data from a specific article, the article number can be entered in a cell. The corresponding name and price are automatically looked up in the table.\n\n![](images/functions/form002-data.png)\n\nEnter the data in a worksheet and use formulas (VLOOKUP) to get the search results.\n\n[File]{.smallcaps}: `Form002.xlsx`\n:::\n\n::: {#exr-form003}\n**Calculating with dates (form003)**\n\nIn the following table, you can enter your date of birth and the pension age (67 years). The date when you get your pension, the current date, and the number of days until your pension date should be calculated with formulas.\n\n![](images/functions/form003-data.png)\n\nCreate this model in a worksheet and use formulas to calculate the output results.\n\n[File]{.smallcaps}: `Form003.xlsx`\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Hint</button>\n\n1.  Used functions: `DATE`, `YEAR`, `MONTH`, `DAY`, `TODAY`.\n\n2.  A date layout like Wed 01/3/1967 can be get through the number format of the cell. Choose [tab Home > Category Custom (group Number)]{.uicontrol}, or right-click on the cell and choose [Format cells]{.uicontrol}. In the box [Type]{.uicontrol}, you can enter the desired format. The format used in the example is ddd dd/m/yyyy. Try also other formats like dddd dd/mmm/yy to figure out how the formatting works.\n\n3.  A date in Excel is in reality just a number, with which you can make calculations. In order to determine the time difference between two dates, you can subtract these two dates.\n\n</div>\n\n:::\n\n:::\n\n::: {#exr-form004}\n**Determining commission (form004)**\n\nA company with three salesmen has the objective that each salesman sells for at least $ 150,000 per year. If that amount is reached their commission will be 6.25% of that sales amount. If not, then their commission will be only 5.5%. In the following figure, you see a model to calculate the commission for each salesman.\n\n![](images/functions/form004-data.png)\n\nCreate this model in a worksheet and use formulas for the calculation of the commissions.\n\n[File]{.smallcaps}: `Form004.xlsx`\n:::\n\n::: {#exr-form005}\n**Birth dates (form005)**\n\nA mother-child center in a hospital would like to have a daily overview of babies who are born too early, too late, and on time. For too early and too late they also want to see how many days too early or too late. And for babies who still have to be born, they want to see they are overdue.\n\n![](images/functions/form005-data.png)\n\nCreate this model in a worksheet. Also, make a similar layout.\n\n[File]{.smallcaps}: `Form005.xlsx`\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Hint</button>\n\n1.  In the last four columns, the answer depends on one or more conditions, so you need to use the function IF.\n2.  In the case of two conditions, you can embed a second IF function within the first IF function. An alternative is to use the AND function within the IF function.\n3.  Birth date is too early when this date is before the expected date.\n4.  A date in Excel is in reality just a number, with which you can perform calculations. So you can determine whether a date is smaller, larger, or the same as another date.\n5.  If no date is known, then the appropriate field is empty. You can check in Excel if a field is empty.\n\n</div>\n\n:::\n\n:::\n\n::: {#exr-form006}\n**VAT return (form006)**\n\nA company buys goods from suppliers and pays sales tax (VAT) to these suppliers. Then the company sells these goods to customers who have to pay VAT to the company. Every quarter, the company must submit a tax declaration. The difference between VAT received (through sales) and VAT paid (through purchases) must be paid to the tax authority. If this difference is negative, then there is a refund to the company. A small entrepreneur can get a reduction for the VAT through the so called Regulation Small Entrepreneurs (RSE). This regulation is worked out in the following table.\n\n![](images/functions/form006-rules.png)\n\n1.  Create a model with cells for data entry of the total sales and prepaid VAT and with cells for the constants (the thresholds and VAT percentage). Calculate in other cells the VAT initially to be paid, the reduction and the final amount to be paid or to received. Use only one VAT rate of 21%. The final amount should automatically be labeled as a payment or a receipt. All amounts must be formatted in whole euros.\n2.  Test the model thoroughly with all possibilities.\n\n[File]{.smallcaps}: `Form006.xlsx`\n:::\n\n::: {#exr-form007}\n**Ticket price (form007)**\n\nThe following table shows the prices of a ticket for a sports game. There are two categories: children and adults. There is also a cell for entering the age (in whole years). After entering the age the ticket price is automatically calculated.\n\n![](images/functions/form007-model.png)\n\nCreate this model in a worksheet. Use an IF function for the price calculation. Test the solution with different ages.\n\n[File]{.smallcaps}: `Form007.xlsx`\n:::\n\n::: {#exr-form008}\n**Property tax (form008)**\n\nThe property tax has two parts, an owner part, and a user part. If the owner occupies the property himself, then he must pay both parts. The rate for both parts depends on the assessment of the value according to the WOZ act. The property tax for 2010 in a certain community amounts for the owner 0.1064% and for the user 0.1224% of the WOZ value.\n\n![](images/functions/form008-model.png)\n\nCreate this model in a worksheet. The calculated values for owner and user depends on the answer “yes” or “no” on both questions.\n\n[File]{.smallcaps}: `Form008.xlsx`\n:::\n\n::: {#exr-form009}\n**Savings deposit (form009)**\n\nAn amount of $ 20,000 will be put for a year in a savings deposit at an interest rate of 2.75%. Create a calculation model in which both the interest and the total amount after one year is calculated.\n\n[File]{.smallcaps}: `Form009.xlsx`\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Answer</button>\n\nInterest = $ 550.00 and Amount = $ 20,550.00\n\n</div>\n\n:::\n\n:::\n\n::: {#exr-form010}\n**Joule's law (form010)**\n\nThe amount of heat generated by an electric current flowing through a conductor can be calculated with Joule's law: $Q = 0.24*i^2*R*t$\n\n+ `Q`: The amount of heat (cal)\n+ `i`: Current (ampere)\n+ `R`: Resistance (ohm)\n+ `t`: Time (sec)\n\nCreate a model in a worksheet in which current, the resistance, and the time can be entered and the amount of heat is calculated from the entered data.\n\n[File]{.smallcaps}: `Form010.xlsx`\n:::\n\n::: {#exr-form011}\n**Investment bond (form011)**\n\nA government bond with a maturity of 5 years annually pays a 3.5% interest rate. Suppose you want to have $300,000 over 5 years, how much do you need to invest in this bond? Use Excels function for present value (PV) to calculate the answer.\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Answer</button>\n\n$ 252,592\n\n</div>\n\n:::\n\n:::\n\n::: {#exr-form012}\n**Multiplication table (form012)**\n\nFirst, create the following table:\n\n![](images/functions/form012-table.png)\n\nThen enter in cell B2 a formula that you can copy down and to the right to the rest of the table so that the value inside each cell in the table is the multiplication of number before the row and the number above the column.\n\n::: {.content-visible when-format=\"html:js\"}\n\n<div class='webex-solution'><button>Hint</button>\n\nYou will need a combination of absolute and relative addressing in your formula.\n\n</div>\n\n:::\n\n:::\n\n::: {#exr-form013}\n**Price olive oil (form013)**\n\nOlive oil can be purchased in cans of 5 liters. The price depends upon the number of cans:\n\n-   $45 per can for the first 20 cans\n-   $40 for any can more than 20\n\nCreate a spreadsheet model where you can enter the total amount of cans and the total price should be calculated. Use cells for the price per can and the 20 cans limit. Give also names to all cells.\n:::\n",
    "supporting": [
      "06-functions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}